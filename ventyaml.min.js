function ventyamlEverything(e){var t=document.querySelectorAll(e);for(var i in t)var s=new ventyaml(t[i])}class ventyaml{constructor(e){if(!YAML){throw"ventyaml: YAML library not loaded."}this.parentDiv=e.parentNode;this.container=document.createElement("figure");this.container.classList.add("ventyaml");this.parentDiv.insertBefore(this.container,e);if(e.tagName=="TEXTAREA"){this.textarea=e}else{this.textarea=document.createElement("textarea");this.textarea.value=e.textContent;this.parentDiv.removeChild(e)}this.container.appendChild(this.textarea);this.textarea.classList.add("ventyamlSource");this.textarea.classList.add("hidden");this.textarea.value=this.textarea.value.trim();this.waveformContainer=document.createElement("div");this.waveformContainer.classList.add("vyamlwc");var t="vyamlwc"+(document.getElementsByClassName("vyamlwc").length+1);this.waveformContainer.id=t;this.container.insertBefore(this.waveformContainer,this.textarea);this.waveformContainer.addEventListener("click",this.toggleSource.bind(this));this.update()}setValue(e){this.textarea.value=e;if("cm"in this){console.log("We have a codemirror instance");this.cm.setValue(e)}}createCM(){if(typeof window.CodeMirror!=="undefined"){this.cm=CodeMirror.fromTextArea(this.textarea,{theme:"midnight",mode:"yaml",matchBrackets:true,showCursorWhenSelecting:true})}else{console.log("Codemirror not available")}}update(){this.yaml=this.textarea.value;this.json=YAML.parse(this.yaml);this.updateLung();this.updateVent();this.run();this.updateGraph()}updateVent(){this.vents=[];if(!("Ventilateur"in this.json)&&!("Ventilateurs"in this.json)){this.vents.push(new sv.PressureControler)}else if("Ventilateur"in this.json){this.vents.push(this.createvent(this.json.Ventilateur))}else if(typeof this.json.Ventilateurs=="object"){for(var e in this.json.Ventilateurs){this.vents.push(this.createvent(this.json.Ventilateurs[e]))}}}updateLung(){this.lungs=[];if("Poumon"in this.json){this.lungs.push(this.createlung(this.json.Poumon))}else if("Poumons"in this.json){for(var e in this.json.Poumons){this.lungs.push(this.createlung(this.json.Poumons[e]))}}else{this.lungs.push(this.createlung("SimpleLung"))}}createvent(e){if(typeof e=="string"){if(e in sv){var t=new sv[e]}}else if(typeof e=="object"){if(!("Mode"in e)){var t=new sv.PressureControler}else if(e.Mode in sv){var t=new sv[e.Mode]}else{console.log("Does not seems to be a valid vent type")}for(var i in e){if(i!=="Mode"&&typeof e[i]=="number"){t[i]=e[i]}}}if(typeof t!="undefined"){return t}}createlung(e){if(typeof e=="string"){if(e in sv){var t=new sv[e]}}else if(typeof e=="object"){if(!("Type"in e)){var t=new sv.SimpleLung}else if(e.Type in sv){var t=new sv[e.Type]}else{console.log("Does not seems to be a valid lung type")}for(var i in e){if(i!=="Type"&&typeof e[i]=="number"){t[i]=e[i]}}}if(typeof t!="undefined"){return t}}run(){this.data=[];for(var e in this.vents){var t=this.vents[e];for(var e in this.lungs){t.time=0;this.data.push(t.ventilate(this.lungs[e]).timeData)}}}updateGraph(){var e=this.waveformContainer;while(e.firstChild){e.removeChild(e.firstChild)}if("Courbes"in this.json){var t=this.json.Courbes;if(typeof t=="object"){for(var i in t){this.createWaveform(t[i])}}else{console.log("ventyaml: Value for courbes must be a string list")}}else if("Courbe"in this.json){this.createWaveform(this.json.Courbe)}if("Boucles"in this.json){for(var i in this.json.Boucles){this.createLoop(this.json.Boucles[i])}}else if("Boucle"in this.json){var s=this.json.Boucle;this.createLoop(s)}if(!("Courbes"in this.json)&&!("Courbe"in this.json)&&!("Boucle"in this.json)&&!("Boucles"in this.json)){this.createWaveform("Flung")}}createWaveform(e){if(typeof e=="string"){function t(e){return e.time}function i(t){return t[e]}var s=gs.addGraph(this.waveformContainer.id,this.data[0],t,i);if(this.data.length>1){for(var n=1;n<this.data.length;n++){s.tracer(this.data[n],t,i)}}}else{console.log("ventyaml: Value for courbes must be a string")}}createLoop(e){if(typeof e=="object"&&"x"in e&&"y"in e&&e.x!=null&&e.y!=null){function t(t){return t[e["x"]]}function i(t){return t[e["y"]]}var s=gs.addGraph(this.waveformContainer.id,this.data[0],t,i,{"class":"loop"});s.setidx(e["x"]);s.setidy(e["y"]);if(this.data.length>1){for(var n=1;n<this.data.length;n++){s.tracer(this.data[n],t,i)}}}else{console.log("ventyaml: invalid loop description")}}toggleSource(){if(this.textarea.classList.contains("hidden")){this.textarea.classList.remove("hidden")}else{this.update();this.textarea.classList.add("hidden")}}}