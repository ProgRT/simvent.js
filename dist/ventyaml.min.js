"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ventyaml=function(){function i(e){for(var t in _classCallCheck(this,i),this.clsList=e.classList,e.classList.keys())console.log(t);if(!YAML)throw"ventyaml: YAML library not loaded.";this.parentDiv=e.parentNode,this.container=document.createElement("figure"),this.container.className=this.clsList,this.container.classList.add("ventyaml"),this.parentDiv.insertBefore(this.container,e),"TEXTAREA"==e.tagName?this.textarea=e:(this.textarea=document.createElement("textarea"),this.textarea.value=e.textContent,this.parentDiv.removeChild(e)),this.container.appendChild(this.textarea),this.textarea.classList.add("ventyamlSource"),this.container.classList.add("hidden"),this.textarea.value=this.textarea.value.trim(),this.waveformContainer=document.createElement("div"),this.waveformContainer.classList.add("vyamlwc");var n="vyamlwc"+(document.getElementsByClassName("vyamlwc").length+1);this.waveformContainer.id=n,this.container.insertBefore(this.waveformContainer,this.textarea),this.waveformContainer.addEventListener("click",this.toggleSource.bind(this)),this.downloadsDiv=document.createElement("div"),this.downloadsDiv.classList.add("downloads"),this.container.appendChild(this.downloadsDiv),this.update()}return _createClass(i,[{key:"setValue",value:function(e){this.textarea.value=e,"cm"in this&&(console.log("We have a codemirror instance"),this.cm.setValue(e))}},{key:"createCM",value:function(){void 0!==window.CodeMirror?this.cm=CodeMirror.fromTextArea(this.textarea,{theme:"midnight",mode:"yaml",matchBrackets:!0,showCursorWhenSelecting:!0}):console.log("Codemirror not available")}},{key:"update",value:function(){this.yaml=this.textarea.value,this.json=YAML.parse(this.yaml),this.updateLung(),this.updateVent(),this.run(),this.updateGraph(),this.updateCaption()}},{key:"updateVent",value:function(){if(this.vents=[],"Ventilateur"in this.json||"Ventilateurs"in this.json){if("Ventilateur"in this.json)this.vents.push(this.createvent(this.json.Ventilateur));else if("object"==_typeof(this.json.Ventilateurs))for(var e in this.json.Ventilateurs)this.vents.push(this.createvent(this.json.Ventilateurs[e]))}else this.vents.push(new sv.PressureControler)}},{key:"updateLung",value:function(){if(this.lungs=[],"Poumon"in this.json)this.lungs.push(this.createlung(this.json.Poumon));else if("Poumons"in this.json)for(var e in this.json.Poumons)this.lungs.push(this.createlung(this.json.Poumons[e]));else this.lungs.push(this.createlung("SimpleLung"))}},{key:"createvent",value:function(e){if("string"==typeof e){if(e in sv)var t=new sv[e]}else if("object"==(void 0===e?"undefined":_typeof(e))){if("Mode"in e)if(e.Mode in sv)t=new sv[e.Mode];else console.log("Does not seems to be a valid vent type");else var t=new sv.PressureControler;for(var n in e)"Mode"!==n&&"number"==typeof e[n]&&(t[n]=e[n])}if(void 0!==t)return t}},{key:"createlung",value:function(e){if("string"==typeof e){if(e in sv)var t=new sv[e]}else if("object"==(void 0===e?"undefined":_typeof(e))){if("Type"in e)if(e.Type in sv)t=new sv[e.Type];else console.log("Does not seems to be a valid lung type");else var t=new sv.SimpleLung;for(var n in e)"Type"!==n&&"number"==typeof e[n]&&(t[n]=e[n])}if(void 0!==t)return t}},{key:"run",value:function(){this.data=[];for(var e=this.downloadsDiv.children,t=0;t<e.length;t++)this.downloadsDiv.removeChild(e[t]);for(var t in this.vents){var n=this.vents[t];for(var t in this.lungs){n.time=0;var i=n.ventilate(this.lungs[t]).timeData;this.data.push(i);var r="object"!=(void 0===i?"undefined":_typeof(i))?JSON.parse(i):i,s="",o="";for(var a in r[0])""!=o&&(o+="\t "),o+=a;s+=o+"\r\n";for(t=0;t<r.length;t++){o="";for(var a in r[t])""!=o&&(o+="\t "),o+=r[t][a];s+=o+"\r\n"}var l=document.createElement("a");l.download="simvent"+this.data.length+".dat",l.href="data:text/tsv;charset=utf-8,"+escape(s),l.textContent=l.download+" ",this.downloadsDiv.appendChild(l)}}}},{key:"updateGraph",value:function(){for(var e=this.waveformContainer;e.firstChild;)e.removeChild(e.firstChild);if("Courbes"in this.json){var t=this.json.Courbes;if("object"==(void 0===t?"undefined":_typeof(t)))for(var n in t)this.createWaveform(t[n]);else console.log("ventyaml: Value for courbes must be a string list")}else"Courbe"in this.json&&this.createWaveform(this.json.Courbe);if("Boucles"in this.json)for(var n in this.json.Boucles)this.createLoop(this.json.Boucles[n]);else if("Boucle"in this.json){var i=this.json.Boucle;this.createLoop(i)}"Courbes"in this.json||"Courbe"in this.json||"Boucle"in this.json||"Boucles"in this.json||this.createWaveform("Flung")}},{key:"createWaveform",value:function(t){if("string"==typeof t){var e=function(e){return e.time},n=function(e){return e[t]},i=gs.addGraph(this.waveformContainer.id,this.data[0],e,n).setidx("Temps (s)").setidy(t);if(1<this.data.length)for(var r=1;r<this.data.length;r++)i.tracer(this.data[r],e,n)}else console.log("ventyaml: Value for courbes must be a string")}},{key:"createLoop",value:function(t){if("object"==(void 0===t?"undefined":_typeof(t))&&"x"in t&&"y"in t&&null!=t.x&&null!=t.y){var e=function(e){return e[t.x]},n=function(e){return e[t.y]},i=gs.addGraph(this.waveformContainer.id,this.data[0],e,n,{class:"loop"});if(i.setidx(t.x),i.setidy(t.y),1<this.data.length)for(var r=1;r<this.data.length;r++)i.tracer(this.data[r],e,n)}else console.log("ventyaml: invalid loop description")}},{key:"toggleSource",value:function(){this.container.classList.contains("hidden")?this.container.classList.remove("hidden"):(this.update(),this.container.classList.add("hidden"))}},{key:"updateCaption",value:function(){"Legende"in this.json&&(this.captionElement=document.createElement("caption"),this.captionElement.textContent=this.json.Legende,this.container.appendChild(this.captionElement))}}]),i}();function ventyamlEverything(e){var t=document.querySelectorAll(e);for(var n in t)if(void 0!==t[n].tagName)new ventyaml(t[n])}!function(s,o,a){function l(n,e){if(!o[n]){if(!s[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(u)return u(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var r=o[n]={exports:{}};s[n][0].call(r.exports,function(e){var t=s[n][1][e];return l(t||e)},r,r.exports,s,s,o,a)}return o[n].exports}for(var u="function"==typeof require&&require,e=0;e<a.length;e++)l(a[e])}({1:[function(e,t,n){var i,p,f;f=e("./Utils"),p=e("./Inline"),i=function(){function e(){}return e.indentation=4,e.prototype.dump=function(e,t,n,i,r){var s,o,a,l,u,c,h;if(null==t&&(t=0),null==n&&(n=0),null==i&&(i=!1),null==r&&(r=null),l="",u=n?f.strRepeat(" ",n):"",t<=0||"object"!=typeof e||e instanceof Date||f.isEmpty(e))l+=u+p.dump(e,i,r);else if(e instanceof Array)for(s=0,a=e.length;s<a;s++)c=e[s],l+=u+"-"+((h=t-1<=0||"object"!=typeof c||f.isEmpty(c))?" ":"\n")+this.dump(c,t-1,h?0:n+this.indentation,i,r)+(h?"\n":"");else for(o in e)c=e[o],h=t-1<=0||"object"!=typeof c||f.isEmpty(c),l+=u+p.dump(o,i,r)+":"+(h?" ":"\n")+this.dump(c,t-1,h?0:n+this.indentation,i,r)+(h?"\n":"");return l},e}(),t.exports=i},{"./Inline":5,"./Utils":9}],2:[function(e,t,n){var i,s;s=e("./Pattern"),i=function(){var e;function r(){}return r.LIST_ESCAPEES=["\\","\\\\",'\\"','"',"\0","","","","","","","","\b","\t","\n","\v","\f","\r","","","","","","","","","","","","","","","","","","",(e=String.fromCharCode)(133),e(160),e(8232),e(8233)],r.LIST_ESCAPED=["\\\\",'\\"','\\"','\\"',"\\0","\\x01","\\x02","\\x03","\\x04","\\x05","\\x06","\\a","\\b","\\t","\\n","\\v","\\f","\\r","\\x0e","\\x0f","\\x10","\\x11","\\x12","\\x13","\\x14","\\x15","\\x16","\\x17","\\x18","\\x19","\\x1a","\\e","\\x1c","\\x1d","\\x1e","\\x1f","\\N","\\_","\\L","\\P"],r.MAPPING_ESCAPEES_TO_ESCAPED=function(){var e,t,n,i;for(n={},e=t=0,i=r.LIST_ESCAPEES.length;0<=i?t<i:i<t;e=0<=i?++t:--t)n[r.LIST_ESCAPEES[e]]=r.LIST_ESCAPED[e];return n}(),r.PATTERN_CHARACTERS_TO_ESCAPE=new s("[\\x00-\\x1f]|Ã‚Â…|Ã‚Â |Ã¢Â€Â¨|Ã¢Â€Â©"),r.PATTERN_MAPPING_ESCAPEES=new s(r.LIST_ESCAPEES.join("|").split("\\").join("\\\\")),r.PATTERN_SINGLE_QUOTING=new s("[\\s'\":{}[\\],&*#?]|^[-?|<>=!%@`]"),r.requiresDoubleQuoting=function(e){return this.PATTERN_CHARACTERS_TO_ESCAPE.test(e)},r.escapeWithDoubleQuotes=function(e){var t;return'"'+this.PATTERN_MAPPING_ESCAPEES.replace(e,(t=this,function(e){return t.MAPPING_ESCAPEES_TO_ESCAPED[e]}))+'"'},r.requiresSingleQuoting=function(e){return this.PATTERN_SINGLE_QUOTING.test(e)},r.escapeWithSingleQuotes=function(e){return"'"+e.replace(/'/g,"''")+"'"},r}(),t.exports=i},{"./Pattern":7}],3:[function(e,t,n){var i,r={}.hasOwnProperty;i=function(e){function t(e,t,n){this.message=e,this.parsedLine=t,this.snippet=n}return function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,Error),t.prototype.toString=function(){return null!=this.parsedLine&&null!=this.snippet?"<DumpException> "+this.message+" (line "+this.parsedLine+": '"+this.snippet+"')":"<DumpException> "+this.message},t}(),t.exports=i},{}],4:[function(e,t,n){var i,r={}.hasOwnProperty;i=function(e){function t(e,t,n){this.message=e,this.parsedLine=t,this.snippet=n}return function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,Error),t.prototype.toString=function(){return null!=this.parsedLine&&null!=this.snippet?"<ParseException> "+this.message+" (line "+this.parsedLine+": '"+this.snippet+"')":"<ParseException> "+this.message},t}(),t.exports=i},{}],5:[function(e,t,n){var o,i,f,d,s,E,T=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};d=e("./Pattern"),s=e("./Unescaper"),o=e("./Escaper"),E=e("./Utils"),f=e("./Exception/ParseException"),e("./Exception/DumpException"),i=function(){function e(){}return e.REGEX_QUOTED_STRING="(?:\"(?:[^\"\\\\]*(?:\\\\.[^\"\\\\]*)*)\"|'(?:[^']*(?:''[^']*)*)')",e.PATTERN_TRAILING_COMMENTS=new d("^\\s*#.*$"),e.PATTERN_QUOTED_SCALAR=new d("^"+e.REGEX_QUOTED_STRING),e.PATTERN_THOUSAND_NUMERIC_SCALAR=new d("^(-|\\+)?[0-9,]+(\\.[0-9]+)?$"),e.PATTERN_SCALAR_BY_DELIMITERS={},e.settings={},e.configure=function(e,t){null==e&&(e=null),null==t&&(t=null),this.settings.exceptionOnInvalidType=e,this.settings.objectDecoder=t},e.parse=function(e,t,n){var i,r;if(null==t&&(t=!1),null==n&&(n=null),this.settings.exceptionOnInvalidType=t,this.settings.objectDecoder=n,null==e)return"";if(0===(e=E.trim(e)).length)return"";switch(i={exceptionOnInvalidType:t,objectDecoder:n,i:0},e.charAt(0)){case"[":r=this.parseSequence(e,i),++i.i;break;case"{":r=this.parseMapping(e,i),++i.i;break;default:r=this.parseScalar(e,null,['"',"'"],i)}if(""!==this.PATTERN_TRAILING_COMMENTS.replace(e.slice(i.i),""))throw new f('Unexpected characters near "'+e.slice(i.i)+'".');return r},e.dump=function(e,t,n){var i,r,s;return null==t&&(t=!1),null==n&&(n=null),null==e?"null":"object"===(s=typeof e)?e instanceof Date?e.toISOString():null==n||"string"!=typeof(r=n(e))&&null==r?this.dumpObject(e):r:"boolean"===s?e?"true":"false":E.isDigits(e)?"string"===s?"'"+e+"'":String(parseInt(e)):E.isNumeric(e)?"string"===s?"'"+e+"'":String(parseFloat(e)):"number"===s?e===1/0?".Inf":e===-1/0?"-.Inf":isNaN(e)?".NaN":e:o.requiresDoubleQuoting(e)?o.escapeWithDoubleQuotes(e):o.requiresSingleQuoting(e)?o.escapeWithSingleQuotes(e):""===e?'""':E.PATTERN_DATE.test(e)?"'"+e+"'":"null"===(i=e.toLowerCase())||"~"===i||"true"===i||"false"===i?"'"+e+"'":e},e.dumpObject=function(e,t,n){var i,r,s,o,a;if(null==n&&(n=null),e instanceof Array){for(o=[],i=0,s=e.length;i<s;i++)a=e[i],o.push(this.dump(a));return"["+o.join(", ")+"]"}for(r in o=[],e)a=e[r],o.push(this.dump(r)+": "+this.dump(a));return"{"+o.join(", ")+"}"},e.parseScalar=function(e,t,n,i,r){var s,o,a,l,u,c,h,p;if(null==t&&(t=null),null==n&&(n=['"',"'"]),null==i&&(i=null),null==r&&(r=!0),null==i&&(i={exceptionOnInvalidType:this.settings.exceptionOnInvalidType,objectDecoder:this.settings.objectDecoder,i:0}),s=i.i,c=e.charAt(s),0<=T.call(n,c)){if(l=this.parseQuotedScalar(e,i),s=i.i,null!=t&&(h=E.ltrim(e.slice(s)," ").charAt(0),!(0<=T.call(t,h))))throw new f("Unexpected characters ("+e.slice(s)+").")}else{if(t){if(o=t.join("|"),null==(u=this.PATTERN_SCALAR_BY_DELIMITERS[o])&&(u=new d("^(.+?)("+o+")"),this.PATTERN_SCALAR_BY_DELIMITERS[o]=u),!(a=u.exec(e.slice(s))))throw new f("Malformed inline YAML string ("+e+").");s+=(l=a[1]).length}else s+=(l=e.slice(s)).length,-1!==(p=l.indexOf(" #"))&&(l=E.rtrim(l.slice(0,p)));r&&(l=this.evaluateScalar(l,i))}return i.i=s,l},e.parseQuotedScalar=function(e,t){var n,i,r;if(n=t.i,!(i=this.PATTERN_QUOTED_SCALAR.exec(e.slice(n))))throw new f("Malformed inline YAML string ("+e.slice(n)+").");return r=i[0].substr(1,i[0].length-2),r='"'===e.charAt(n)?s.unescapeDoubleQuotedString(r):s.unescapeSingleQuotedString(r),n+=i[0].length,t.i=n,r},e.parseSequence=function(e,t){var n,i,r,s,o,a;for(s=[],r=e.length,n=t.i,n+=1;n<r;){switch(t.i=n,e.charAt(n)){case"[":s.push(this.parseSequence(e,t)),n=t.i;break;case"{":s.push(this.parseMapping(e,t)),n=t.i;break;case"]":return s;case",":case" ":case"\n":break;default:if(i='"'===(o=e.charAt(n))||"'"===o,a=this.parseScalar(e,[",","]"],['"',"'"],t),n=t.i,!i&&"string"==typeof a&&(-1!==a.indexOf(": ")||-1!==a.indexOf(":\n")))try{a=this.parseMapping("{"+a+"}")}catch(e){e}s.push(a),--n}++n}throw new f("Malformed inline YAML string "+e)},e.parseMapping=function(e,t){var n,i,r,s,o,a,l;for(o={},s=e.length,i=t.i,i+=1,a=!1;i<s;){switch(t.i=i,e.charAt(i)){case" ":case",":case"\n":++i,t.i=i,a=!0;break;case"}":return o}if(a)a=!1;else for(r=this.parseScalar(e,[":"," ","\n"],['"',"'"],t,!1),i=t.i,n=!1;i<s;){switch(t.i=i,e.charAt(i)){case"[":l=this.parseSequence(e,t),i=t.i,void 0===o[r]&&(o[r]=l),n=!0;break;case"{":l=this.parseMapping(e,t),i=t.i,void 0===o[r]&&(o[r]=l),n=!0;break;case":":case" ":case"\n":break;default:l=this.parseScalar(e,[",","}"],['"',"'"],t),i=t.i,void 0===o[r]&&(o[r]=l),n=!0,--i}if(++i,n)break}}throw new f("Malformed inline YAML string "+e)},e.evaluateScalar=function(e,t){var n,i,r,s,o,a,l,u,c;switch(l=(e=E.trim(e)).toLowerCase()){case"null":case"":case"~":return null;case"true":return!0;case"false":return!1;case".inf":return 1/0;case".nan":return NaN;case"-.inf":return 1/0;default:switch(l.charAt(0)){case"!":switch(-1===(s=e.indexOf(" "))?l:l.slice(0,s)){case"!":return-1!==s?parseInt(this.parseScalar(e.slice(2))):null;case"!str":return E.ltrim(e.slice(4));case"!!str":return E.ltrim(e.slice(5));case"!!int":return parseInt(this.parseScalar(e.slice(5)));case"!!bool":return E.parseBoolean(this.parseScalar(e.slice(6)),!1);case"!!float":return parseFloat(this.parseScalar(e.slice(7)));case"!!timestamp":return E.stringToDate(E.ltrim(e.slice(11)));default:if(null==t&&(t={exceptionOnInvalidType:this.settings.exceptionOnInvalidType,objectDecoder:this.settings.objectDecoder,i:0}),o=t.objectDecoder,r=t.exceptionOnInvalidType,o)return-1===(s=(c=E.rtrim(e)).indexOf(" "))?o(c,null):(0<(u=E.ltrim(c.slice(s+1))).length||(u=null),o(c.slice(0,s),u));if(r)throw new f("Custom object support when parsing a YAML file has been disabled.");return null}break;case"0":return"0x"===e.slice(0,2)?E.hexDec(e):E.isDigits(e)?E.octDec(e):E.isNumeric(e)?parseFloat(e):e;case"+":return E.isDigits(e)?(a=e,n=parseInt(a),a===String(n)?n:a):E.isNumeric(e)?parseFloat(e):this.PATTERN_THOUSAND_NUMERIC_SCALAR.test(e)?parseFloat(e.replace(",","")):e;case"-":return E.isDigits(e.slice(1))?"0"===e.charAt(1)?-E.octDec(e.slice(1)):(a=e.slice(1),n=parseInt(a),a===String(n)?-n:-a):E.isNumeric(e)?parseFloat(e):this.PATTERN_THOUSAND_NUMERIC_SCALAR.test(e)?parseFloat(e.replace(",","")):e;default:return(i=E.stringToDate(e))?i:E.isNumeric(e)?parseFloat(e):this.PATTERN_THOUSAND_NUMERIC_SCALAR.test(e)?parseFloat(e.replace(",","")):e}}},e}(),t.exports=i},{"./Escaper":2,"./Exception/DumpException":3,"./Exception/ParseException":4,"./Pattern":7,"./Unescaper":8,"./Utils":9}],6:[function(e,t,n){var k,X,i,f,F;k=e("./Inline"),f=e("./Pattern"),F=e("./Utils"),X=e("./Exception/ParseException"),i=function(){function U(e){this.offset=null!=e?e:0,this.lines=[],this.currentLineNb=-1,this.currentLine="",this.refs={}}return U.prototype.PATTERN_FOLDED_SCALAR_ALL=new f("^(?:(?<type>![^\\|>]*)\\s+)?(?<separator>\\||>)(?<modifiers>\\+|\\-|\\d+|\\+\\d+|\\-\\d+|\\d+\\+|\\d+\\-)?(?<comments> +#.*)?$"),U.prototype.PATTERN_FOLDED_SCALAR_END=new f("(?<separator>\\||>)(?<modifiers>\\+|\\-|\\d+|\\+\\d+|\\-\\d+|\\d+\\+|\\d+\\-)?(?<comments> +#.*)?$"),U.prototype.PATTERN_SEQUENCE_ITEM=new f("^\\-((?<leadspaces>\\s+)(?<value>.+?))?\\s*$"),U.prototype.PATTERN_ANCHOR_VALUE=new f("^&(?<ref>[^ ]+) *(?<value>.*)"),U.prototype.PATTERN_COMPACT_NOTATION=new f("^(?<key>"+k.REGEX_QUOTED_STRING+"|[^ '\"\\{\\[].*?) *\\:(\\s+(?<value>.+?))?\\s*$"),U.prototype.PATTERN_MAPPING_ITEM=new f("^(?<key>"+k.REGEX_QUOTED_STRING+"|[^ '\"\\[\\{].*?) *\\:(\\s+(?<value>.+?))?\\s*$"),U.prototype.PATTERN_DECIMAL=new f("\\d+"),U.prototype.PATTERN_INDENT_SPACES=new f("^ +"),U.prototype.PATTERN_TRAILING_LINES=new f("(\n*)$"),U.prototype.PATTERN_YAML_HEADER=new f("^\\%YAML[: ][\\d\\.]+.*\n"),U.prototype.PATTERN_LEADING_COMMENTS=new f("^(\\#.*?\n)+"),U.prototype.PATTERN_DOCUMENT_MARKER_START=new f("^\\-\\-\\-.*?\n"),U.prototype.PATTERN_DOCUMENT_MARKER_END=new f("^\\.\\.\\.\\s*$"),U.prototype.PATTERN_FOLDED_SCALAR_BY_INDENTATION={},U.prototype.CONTEXT_NONE=0,U.prototype.CONTEXT_SEQUENCE=1,U.prototype.CONTEXT_MAPPING=2,U.prototype.parse=function(e,t,n){var i,r,s,o,a,l,u,c,h,p,f,d,E,T,v,g,m,L,A,_,N,C,y,x,R,S,w,I,b,P,D,O,M,j,G;for(null==t&&(t=!1),null==n&&(n=null),this.currentLineNb=-1,this.currentLine="",this.lines=this.cleanup(e).split("\n"),a=null,o=this.CONTEXT_NONE,r=!1;this.moveToNextLine();)if(!this.isCurrentLineEmpty()){if("\t"===this.currentLine[0])throw new X("A YAML file cannot contain tabs as indentation.",this.getRealCurrentLineNb()+1,this.currentLine);if(p=y=!1,G=this.PATTERN_SEQUENCE_ITEM.exec(this.currentLine)){if(this.CONTEXT_MAPPING===o)throw new X("You cannot define a sequence item when in a mapping");o=this.CONTEXT_SEQUENCE,null==a&&(a=[]),null!=G.value&&(C=this.PATTERN_ANCHOR_VALUE.exec(G.value))&&(p=C.ref,G.value=C.value),null==G.value||""===F.trim(G.value," ")||0===F.ltrim(G.value," ").indexOf("#")?this.currentLineNb<this.lines.length-1&&!this.isNextLineUnIndentedCollection()?((I=new U(this.getRealCurrentLineNb()+1)).refs=this.refs,a.push(I.parse(this.getNextEmbedBlock(null,!0),t,n))):a.push(null):(null!=(b=G.leadspaces)?b.length:void 0)&&(C=this.PATTERN_COMPACT_NOTATION.exec(G.value))?((I=new U(this.getRealCurrentLineNb())).refs=this.refs,s=G.value,h=this.getCurrentLineIndentation(),this.isNextLineIndented(!1)&&(s+="\n"+this.getNextEmbedBlock(h+G.leadspaces.length+1,!0)),a.push(I.parse(s,t,n))):a.push(this.parseValue(G.value,t,n))}else{if(!(G=this.PATTERN_MAPPING_ITEM.exec(this.currentLine))||-1!==G.key.indexOf(" #")){if(1===(_=this.lines.length)||2===_&&F.isEmpty(this.lines[1])){try{e=k.parse(this.lines[0],t,n)}catch(e){throw(l=e).parsedLine=this.getRealCurrentLineNb()+1,l.snippet=this.currentLine,l}if("object"==typeof e){if(e instanceof Array)u=e[0];else for(E in e){u=e[E];break}if("string"==typeof u&&0===u.indexOf("*")){for(a=[],x=0,A=e.length;x<A;x++)i=e[x],a.push(this.refs[i.slice(1)]);e=a}}return e}if("["===(D=F.ltrim(e).charAt(0))||"{"===D)try{return k.parse(e,t,n)}catch(e){throw(l=e).parsedLine=this.getRealCurrentLineNb()+1,l.snippet=this.currentLine,l}throw new X("Unable to parse.",this.getRealCurrentLineNb()+1,this.currentLine)}if(this.CONTEXT_SEQUENCE===o)throw new X("You cannot define a mapping item when in a sequence");o=this.CONTEXT_MAPPING,null==a&&(a={}),k.configure(t,n);try{E=k.parseScalar(G.key)}catch(e){throw(l=e).parsedLine=this.getRealCurrentLineNb()+1,l.snippet=this.currentLine,l}if("<<"===E)if(r=y=!0,0===(null!=(P=G.value)?P.indexOf("*"):void 0)){if(O=G.value.slice(1),null==this.refs[O])throw new X('Reference "'+O+'" does not exist.',this.getRealCurrentLineNb()+1,this.currentLine);if("object"!=typeof(M=this.refs[O]))throw new X("YAML merge keys used with a scalar value instead of an object.",this.getRealCurrentLineNb()+1,this.currentLine);if(M instanceof Array)for(c=f=0,g=M.length;f<g;c=++f)e=M[c],null==a[R=String(c)]&&(a[R]=e);else for(E in M)e=M[E],null==a[E]&&(a[E]=e)}else{if(e=null!=G.value&&""!==G.value?G.value:this.getNextEmbedBlock(),(I=new U(this.getRealCurrentLineNb()+1)).refs=this.refs,"object"!=typeof(S=I.parse(e,t)))throw new X("YAML merge keys used with a scalar value instead of an object.",this.getRealCurrentLineNb()+1,this.currentLine);if(S instanceof Array)for(T=0,m=S.length;T<m;T++){if("object"!=typeof(w=S[T]))throw new X("Merge items must be objects.",this.getRealCurrentLineNb()+1,w);if(w instanceof Array)for(c=N=0,L=w.length;N<L;c=++N)e=w[c],d=String(c),a.hasOwnProperty(d)||(a[d]=e);else for(E in w)e=w[E],a.hasOwnProperty(E)||(a[E]=e)}else for(E in S)e=S[E],a.hasOwnProperty(E)||(a[E]=e)}else null!=G.value&&(C=this.PATTERN_ANCHOR_VALUE.exec(G.value))&&(p=C.ref,G.value=C.value);y||(null==G.value||""===F.trim(G.value," ")||0===F.ltrim(G.value," ").indexOf("#")?this.isNextLineIndented()||this.isNextLineUnIndentedCollection()?((I=new U(this.getRealCurrentLineNb()+1)).refs=this.refs,j=I.parse(this.getNextEmbedBlock(),t,n),(r||void 0===a[E])&&(a[E]=j)):(r||void 0===a[E])&&(a[E]=null):(j=this.parseValue(G.value,t,n),(r||void 0===a[E])&&(a[E]=j)))}if(p)if(a instanceof Array)this.refs[p]=a[a.length-1];else{for(E in v=null,a)v=E;this.refs[p]=a[v]}}return F.isEmpty(a)?null:a},U.prototype.getRealCurrentLineNb=function(){return this.currentLineNb+this.offset},U.prototype.getCurrentLineIndentation=function(){return this.currentLine.length-F.ltrim(this.currentLine," ").length},U.prototype.getNextEmbedBlock=function(e,t){var n,i,r,s,o,a,l;if(null==e&&(e=null),null==t&&(t=!1),this.moveToNextLine(),null==e){if(s=this.getCurrentLineIndentation(),l=this.isStringUnIndentedCollectionItem(this.currentLine),!this.isCurrentLineEmpty()&&0===s&&!l)throw new X("Indentation problem.",this.getRealCurrentLineNb()+1,this.currentLine)}else s=e;for(n=[this.currentLine.slice(s)],t||(r=this.isStringUnIndentedCollectionItem(this.currentLine)),o=!(a=this.PATTERN_FOLDED_SCALAR_END).test(this.currentLine);this.moveToNextLine();){if((i=this.getCurrentLineIndentation())===s&&(o=!a.test(this.currentLine)),r&&!this.isStringUnIndentedCollectionItem(this.currentLine)&&i===s){this.moveToPreviousLine();break}if(this.isCurrentLineBlank())n.push(this.currentLine.slice(s));else if(!o||!this.isCurrentLineComment()||i!==s)if(s<=i)n.push(this.currentLine.slice(s));else if("#"!==F.ltrim(this.currentLine).charAt(0)){if(0===i){this.moveToPreviousLine();break}throw new X("Indentation problem.",this.getRealCurrentLineNb()+1,this.currentLine)}}return n.join("\n")},U.prototype.moveToNextLine=function(){return!(this.currentLineNb>=this.lines.length-1)&&(this.currentLine=this.lines[++this.currentLineNb],!0)},U.prototype.moveToPreviousLine=function(){this.currentLine=this.lines[--this.currentLineNb]},U.prototype.parseValue=function(t,n,i){var r,e,s,o,a,l,u,c;if(0===t.indexOf("*")){if(t=-1!==(a=t.indexOf("#"))?t.substr(1,a-2):t.slice(1),void 0===this.refs[t])throw new X('Reference "'+t+'" does not exist.',this.currentLine);return this.refs[t]}if(s=this.PATTERN_FOLDED_SCALAR_ALL.exec(t))return o=null!=(l=s.modifiers)?l:"",e=Math.abs(parseInt(o)),isNaN(e)&&(e=0),c=this.parseFoldedScalar(s.separator,this.PATTERN_DECIMAL.replace(o,""),e),null!=s.type?(k.configure(n,i),k.parseScalar(s.type+" "+c)):c;try{return k.parse(t,n,i)}catch(e){if(r=e,"["!==(u=t.charAt(0))&&"{"!==u||!(r instanceof X)||!this.isNextLineIndented())throw r.parsedLine=this.getRealCurrentLineNb()+1,r.snippet=this.currentLine,r;t+="\n"+this.getNextEmbedBlock();try{return k.parse(t,n,i)}catch(e){throw(r=e).parsedLine=this.getRealCurrentLineNb()+1,r.snippet=this.currentLine,r}}},U.prototype.parseFoldedScalar=function(e,t,n){var i,r,s,o,a,l,u,c,h,p;if(null==t&&(t=""),null==n&&(n=0),!(u=this.moveToNextLine()))return"";for(i=this.isCurrentLineBlank(),p="";u&&i;)(u=this.moveToNextLine())&&(p+="\n",i=this.isCurrentLineBlank());if(0===n&&(a=this.PATTERN_INDENT_SPACES.exec(this.currentLine))&&(n=a[0].length),0<n)for(null==(c=this.PATTERN_FOLDED_SCALAR_BY_INDENTATION[n])&&(c=new f("^ {"+n+"}(.*)$"),U.prototype.PATTERN_FOLDED_SCALAR_BY_INDENTATION[n]=c);u&&(i||(a=c.exec(this.currentLine)));)p+=i?this.currentLine.slice(n):a[1],(u=this.moveToNextLine())&&(p+="\n",i=this.isCurrentLineBlank());else u&&(p+="\n");if(u&&this.moveToPreviousLine(),">"===e){for(l="",r=0,s=(h=p.split("\n")).length;r<s;r++)0===(o=h[r]).length||" "===o.charAt(0)?l=F.rtrim(l," ")+o+"\n":l+=o+" ";p=l}return"+"!==t&&(p=F.rtrim(p)),""===t?p=this.PATTERN_TRAILING_LINES.replace(p,"\n"):"-"===t&&(p=this.PATTERN_TRAILING_LINES.replace(p,"")),p},U.prototype.isNextLineIndented=function(e){var t,n,i;if(null==e&&(e=!0),n=this.getCurrentLineIndentation(),t=!this.moveToNextLine(),e)for(;!t&&this.isCurrentLineEmpty();)t=!this.moveToNextLine();else for(;!t&&this.isCurrentLineBlank();)t=!this.moveToNextLine();return!t&&(i=!1,this.getCurrentLineIndentation()>n&&(i=!0),this.moveToPreviousLine(),i)},U.prototype.isCurrentLineEmpty=function(){var e;return 0===(e=F.trim(this.currentLine," ")).length||"#"===e.charAt(0)},U.prototype.isCurrentLineBlank=function(){return""===F.trim(this.currentLine," ")},U.prototype.isCurrentLineComment=function(){return"#"===F.ltrim(this.currentLine," ").charAt(0)},U.prototype.cleanup=function(e){var t,n,i,r,s,o,a,l,u,c,h,p,f,d;for(-1!==e.indexOf("\r")&&(e=e.split("\r\n").join("\n").split("\r").join("\n")),t=0,e=(c=this.PATTERN_YAML_HEADER.replaceAll(e,""))[0],t=c[1],this.offset+=t,d=(h=this.PATTERN_LEADING_COMMENTS.replaceAll(e,"",1))[0],1===(t=h[1])&&(this.offset+=F.subStrCount(e,"\n")-F.subStrCount(d,"\n"),e=d),d=(p=this.PATTERN_DOCUMENT_MARKER_START.replaceAll(e,"",1))[0],1===(t=p[1])&&(this.offset+=F.subStrCount(e,"\n")-F.subStrCount(d,"\n"),e=d,e=this.PATTERN_DOCUMENT_MARKER_END.replace(e,"")),f=-1,r=0,o=(u=e.split("\n")).length;r<o;r++)l=u[r],0!==F.trim(l," ").length&&(i=l.length-F.ltrim(l).length,(-1===f||i<f)&&(f=i));if(0<f){for(n=s=0,a=u.length;s<a;n=++s)l=u[n],u[n]=l.slice(f);e=u.join("\n")}return e},U.prototype.isNextLineUnIndentedCollection=function(e){var t,n;for(null==e&&(e=null),null==e&&(e=this.getCurrentLineIndentation()),t=this.moveToNextLine();t&&this.isCurrentLineEmpty();)t=this.moveToNextLine();return!1!==t&&(n=!1,this.getCurrentLineIndentation()===e&&this.isStringUnIndentedCollectionItem(this.currentLine)&&(n=!0),this.moveToPreviousLine(),n)},U.prototype.isStringUnIndentedCollectionItem=function(){return"-"===this.currentLine||"- "===this.currentLine.slice(0,2)},U}(),t.exports=i},{"./Exception/ParseException":4,"./Inline":5,"./Pattern":7,"./Utils":9}],7:[function(e,t,n){var i;i=function(){function e(e,t){var n,i,r,s,o,a,l,u,c;for(null==t&&(t=""),r="",o=e.length,a=null,s=i=0;s<o;){if("\\"===(n=e.charAt(s)))r+=e.slice(s,+(s+1)+1||9e9),s++;else if("("===n)if(s<o-2)if("(?:"===(u=e.slice(s,+(s+2)+1||9e9)))s+=2,r+=u;else if("(?<"===u)for(i++,s+=2,l="";s+1<o;){if(">"===(c=e.charAt(s+1))){r+="(",s++,0<l.length&&(null==a&&(a={}),a[l]=i);break}l+=c,s++}else r+=n,i++;else r+=n;else r+=n;s++}this.rawRegex=e,this.cleanedRegex=r,this.regex=new RegExp(this.cleanedRegex,"g"+t.replace("g","")),this.mapping=a}return e.prototype.regex=null,e.prototype.rawRegex=null,e.prototype.cleanedRegex=null,e.prototype.mapping=null,e.prototype.exec=function(e){var t,n,i,r;if(this.regex.lastIndex=0,null==(n=this.regex.exec(e)))return null;if(null!=this.mapping)for(i in r=this.mapping)t=r[i],n[i]=n[t];return n},e.prototype.test=function(e){return this.regex.lastIndex=0,this.regex.test(e)},e.prototype.replace=function(e,t){return this.regex.lastIndex=0,e.replace(this.regex,t)},e.prototype.replaceAll=function(e,t,n){var i;for(null==n&&(n=0),i=this.regex.lastIndex=0;this.regex.test(e)&&(0===n||i<n);)this.regex.lastIndex=0,e=e.replace(this.regex,""),i++;return[e,i]},e}(),t.exports=i},{}],8:[function(e,t,n){var i,r,s;s=e("./Utils"),i=e("./Pattern"),r=function(){function e(){}return e.PATTERN_ESCAPED_CHARACTER=new i('\\\\([0abt\tnvfre "\\/\\\\N_LP]|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|U[0-9a-fA-F]{8})'),e.unescapeSingleQuotedString=function(e){return e.replace(/\'\'/g,"'")},e.unescapeDoubleQuotedString=function(e){var t;return null==this._unescapeCallback&&(this._unescapeCallback=(t=this,function(e){return t.unescapeCharacter(e)})),this.PATTERN_ESCAPED_CHARACTER.replace(e,this._unescapeCallback)},e.unescapeCharacter=function(e){var t;switch(t=String.fromCharCode,e.charAt(1)){case"0":return t(0);case"a":return t(7);case"b":return t(8);case"t":case"\t":return"\t";case"n":return"\n";case"v":return t(11);case"f":return t(12);case"r":return t(13);case"e":return t(27);case" ":return" ";case'"':return'"';case"/":return"/";case"\\":return"\\";case"N":return t(133);case"_":return t(160);case"L":return t(8232);case"P":return t(8233);case"x":return s.utf8chr(s.hexDec(e.substr(2,2)));case"u":return s.utf8chr(s.hexDec(e.substr(2,4)));case"U":return s.utf8chr(s.hexDec(e.substr(2,8)));default:return""}},e}(),t.exports=r},{"./Pattern":7,"./Utils":9}],9:[function(u,e,t){var n,i;n=u("./Pattern"),i=function(){function e(){}return e.REGEX_LEFT_TRIM_BY_CHAR={},e.REGEX_RIGHT_TRIM_BY_CHAR={},e.REGEX_SPACES=/\s+/g,e.REGEX_DIGITS=/^\d+$/,e.REGEX_OCTAL=/[^0-7]/gi,e.REGEX_HEXADECIMAL=/[^a-f0-9]/gi,e.PATTERN_DATE=new n("^(?<year>[0-9][0-9][0-9][0-9])-(?<month>[0-9][0-9]?)-(?<day>[0-9][0-9]?)(?:(?:[Tt]|[ \t]+)(?<hour>[0-9][0-9]?):(?<minute>[0-9][0-9]):(?<second>[0-9][0-9])(?:.(?<fraction>[0-9]*))?(?:[ \t]*(?<tz>Z|(?<tz_sign>[-+])(?<tz_hour>[0-9][0-9]?)(?::(?<tz_minute>[0-9][0-9]))?))?)?$","i"),e.LOCAL_TIMEZONE_OFFSET=60*(new Date).getTimezoneOffset()*1e3,e.trim=function(e,t){return null==t&&(t="\\s"),e.trim()},e.ltrim=function(e,t){var n;return null==t&&(t="\\s"),null==(n=this.REGEX_LEFT_TRIM_BY_CHAR[t])&&(this.REGEX_LEFT_TRIM_BY_CHAR[t]=n=new RegExp("^"+t+t+"*")),n.lastIndex=0,e.replace(n,"")},e.rtrim=function(e,t){var n;return null==t&&(t="\\s"),null==(n=this.REGEX_RIGHT_TRIM_BY_CHAR[t])&&(this.REGEX_RIGHT_TRIM_BY_CHAR[t]=n=new RegExp(t+""+t+"*$")),n.lastIndex=0,e.replace(n,"")},e.isEmpty=function(e){return!e||""===e||"0"===e||e instanceof Array&&0===e.length},e.subStrCount=function(e,t,n,i){var r,s,o,a,l,u;for(r=0,e=""+e,t=""+t,null!=n&&(e=e.slice(n)),null!=i&&(e=e.slice(0,i)),a=e.length,u=t.length,s=o=0,l=a;0<=l?o<l:l<o;s=0<=l?++o:--o)t===e.slice(s,u)&&(r++,s+=u-1);return r},e.isDigits=function(e){return this.REGEX_DIGITS.lastIndex=0,this.REGEX_DIGITS.test(e)},e.octDec=function(e){return this.REGEX_OCTAL.lastIndex=0,parseInt((e+"").replace(this.REGEX_OCTAL,""),8)},e.hexDec=function(e){return this.REGEX_HEXADECIMAL.lastIndex=0,"0x"===((e=this.trim(e))+"").slice(0,2)&&(e=(e+"").slice(2)),parseInt((e+"").replace(this.REGEX_HEXADECIMAL,""),16)},e.utf8chr=function(e){var t;return t=String.fromCharCode,(e%=2097152)<128?t(e):e<2048?t(192|e>>6)+t(128|63&e):e<65536?t(224|e>>12)+t(128|e>>6&63)+t(128|63&e):t(240|e>>18)+t(128|e>>12&63)+t(128|e>>6&63)+t(128|63&e)},e.parseBoolean=function(e,t){var n;return null==t&&(t=!0),"string"==typeof e?(n=e.toLowerCase(),!(!t&&"no"===n)&&("0"!==n&&("false"!==n&&""!==n))):!!e},e.isNumeric=function(e){return this.REGEX_SPACES.lastIndex=0,"number"==typeof e||"string"==typeof e&&!isNaN(e)&&""!==e.replace(this.REGEX_SPACES,"")},e.stringToDate=function(e){var t,n,i,r,s,o,a,l,u,c;if(!(null!=e?e.length:void 0))return null;if(!(s=this.PATTERN_DATE.exec(e)))return null;if(c=parseInt(s.year,10),a=parseInt(s.month,10)-1,n=parseInt(s.day,10),null==s.hour)return t=new Date(Date.UTC(c,a,n));if(r=parseInt(s.hour,10),o=parseInt(s.minute,10),l=parseInt(s.second,10),null!=s.fraction){for(i=s.fraction.slice(0,3);i.length<3;)i+="0";i=parseInt(i,10)}else i=0;return null!=s.tz&&(u=6e4*(60*parseInt(s.tz_hour,10)+(null!=s.tz_minute?parseInt(s.tz_minute,10):0)),"-"===s.tz_sign&&(u*=-1)),t=new Date(Date.UTC(c,a,n,r,o,l,i)),u&&t.setTime(t.getTime()+u),t},e.strRepeat=function(e,t){var n,i;for(i="",n=0;n<t;)i+=e,n++;return i},e.getStringFromFile=function(e,n){var t,i,r,s,o,a,l;if(null==n&&(n=null),l=null,"undefined"!=typeof window&&null!==window)if(window.XMLHttpRequest)l=new XMLHttpRequest;else if(window.ActiveXObject)for(r=0,s=(a=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"]).length;r<s;r++){o=a[r];try{l=new ActiveXObject(o)}catch(e){}}return null!=l?null!=n?(l.onreadystatechange=function(){if(4===l.readyState)return 200===l.status||0===l.status?n(l.responseText):n(null)},l.open("GET",e,!0),l.send(null)):(l.open("GET",e,!1),l.send(null),200===l.status||0===l.status?l.responseText:null):(i=u("fs"),null!=n?i.readFile(e,function(e,t){return n(e?null:String(t))}):null!=(t=i.readFileSync(e))?String(t):null)},e}(),e.exports=i},{"./Pattern":7}],10:[function(t,e,n){var o,i,a,r;i=t("./Parser"),o=t("./Dumper"),a=t("./Utils"),r=function(){function e(){}return e.parse=function(e,t,n){return null==t&&(t=!1),null==n&&(n=null),(new i).parse(e,t,n)},e.parseFile=function(e,n,i,r){var t,s;return null==n&&(n=null),null==i&&(i=!1),null==r&&(r=null),null!=n?a.getStringFromFile(e,(s=this,function(e){var t;(t=null)!=e&&(t=s.parse(e,i,r)),n(t)})):null!=(t=a.getStringFromFile(e))?this.parse(t,i,r):null},e.dump=function(e,t,n,i,r){var s;return null==t&&(t=2),null==n&&(n=4),null==i&&(i=!1),null==r&&(r=null),(s=new o).indentation=n,s.dump(e,t,0,i,r)},e.register=function(){var e;if(e=function(e,t){return e.exports=YAML.parseFile(t)},null!=(null!=t?t.extensions:void 0))return t.extensions[".yml"]=e,t.extensions[".yaml"]=e},e.stringify=function(e,t,n,i,r){return this.dump(e,t,n,i,r)},e.load=function(e,t,n,i){return this.parseFile(e,t,n,i)},e}(),"undefined"!=typeof window&&null!==window&&(window.YAML=r),"undefined"!=typeof window&&null!==window||(this.YAML=r),e.exports=r},{"./Dumper":1,"./Parser":6,"./Utils":9}]},{},[10]);